$ curl --silent https://raw.githubusercontent.com/emvaldes/devops-systems/master/ubuntu/modules/ubuntu-postinstall.shell | bash -x - ;

  + [[ 0 -gt 0 ]]
+ export vagrant_boxset=bento/ubuntu-22.04
+ vagrant_boxset=bento/ubuntu-22.04
+ export vagrant_cloudset=bento
+ vagrant_cloudset=bento
+ export vagrant_instance=ubuntu-22.04
+ vagrant_instance=ubuntu-22.04
+ [[ 0 -gt 0 ]]
+ export devops_account=devops
+ devops_account=devops
+ [[ 0 -gt 0 ]]
+ export devops_sshkey=devnetops.pub
+ devops_sshkey=devnetops.pub
+ export authorized_keys=/home/devops/.ssh/authorized_keys
+ authorized_keys=/home/devops/.ssh/authorized_keys
+ export vagrant_projects=/Users/emvaldes/.vagrant.d
+ vagrant_projects=/Users/emvaldes/.vagrant.d
+ mkdir -p /Users/emvaldes/.vagrant.d/sources
+ export vagrant_location=/Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ vagrant_location=/Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ mkdir -p /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ export github_content=raw.githubusercontent.com
+ github_content=raw.githubusercontent.com
+ export github_repo=emvaldes/devops-systems
+ github_repo=emvaldes/devops-systems
+ export local_temp=/Users/emvaldes/.local/tmp
+ local_temp=/Users/emvaldes/.local/tmp
+ export vagrant_temp=/Users/emvaldes/.local/tmp/vagrant
+ vagrant_temp=/Users/emvaldes/.local/tmp/vagrant
+ mkdir -p /Users/emvaldes/.local/tmp/vagrant/shared
+ export counter=0
+ counter=0
+ alias check-status=check_status
+ alias vagrant-review=vagrant_review
+ alias vagrant-addbox=vagrant_addbox
+ alias vagrant-initbox=vagrant_initbox
+ alias patch-vagrantfile=patch_vagrantfile
+ alias vagrant-deploy=vagrant_deploy
+ alias vagrant-config=vagrant_config
+ alias vagrant-access=vagrant_access
+ alias service-account=service_account
+ alias sudoers-privileges=sudoers_privileges
+ alias transfer-credentials=transfer_credentials
+ alias sudoers-autologin=sudoers_autologin
+ alias service-access=service_access
+ alias config-section=config_section
+ alias preinst-package=preinst_package
+ alias postinst-package=postinst_package
+ alias destroy-appliance=destroy_appliance
+ alias vagrant-appliance=vagrant_appliance
+ vagrant_appliance
+ mkdir -pv /Users/emvaldes/.local/tmp/vagrant/shared
+ vagrant_review
+ tree -a /Users/emvaldes/.vagrant.d
/Users/emvaldes/.vagrant.d
├── boxes
├── data
│   ├── checkpoint_cache
│   ├── checkpoint_signature
│   ├── fp-leases
│   ├── lock.dotlock.lock
│   ├── lock.machine-action-6533b421ab71ab7fcdc9e16e11e04fba.lock
│   ├── machine-index
│   │   ├── index
│   │   └── index.lock
│   └── vbox_symlink_create_warning
├── gems
│   ├── 2.6.7
│   ├── 2.7.4
│   └── 2.7.6
├── insecure_private_key
├── rgloader
│   └── loader.rb
├── setup_version
├── sources
│   └── ubuntu-22.04
└── tmp

13 directories, 10 files
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant box list
There are no installed boxes! Use `vagrant box add` to add some.
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
++ vagrant box list
++ grep -F bento/ubuntu-22.04
+ local existing=
+ [[ 0 -gt 0 ]]
+ return 0
+ vagrant_addbox
+ vagrant box add bento/ubuntu-22.04 --force --provider virtualbox
==> box: Loading metadata for box 'bento/ubuntu-22.04'
    box: URL: https://vagrantcloud.com/bento/ubuntu-22.04
==> box: Adding box 'bento/ubuntu-22.04' (v202212.11.0) for provider: virtualbox
    box: Downloading: https://vagrantcloud.com/bento/boxes/ubuntu-22.04/versions/202212.11.0/providers/virtualbox.box
==> box: Successfully added box 'bento/ubuntu-22.04' (v202212.11.0) for 'virtualbox'!
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ tree -a /Users/emvaldes/.vagrant.d/boxes
/Users/emvaldes/.vagrant.d/boxes
└── bento-VAGRANTSLASH-ubuntu-22.04
    ├── 202212.11.0
    │   └── virtualbox
    │       ├── Vagrantfile
    │       ├── box.ovf
    │       ├── metadata.json
    │       └── ubuntu-22.04-amd64-disk001.vmdk
    └── metadata_url

4 directories, 5 files
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant box list
bento/ubuntu-22.04 (virtualbox, 202212.11.0)
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ vagrant_initbox
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ mkdir -p /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant init bento/ubuntu-22.04
A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ tree -a /Users/emvaldes/.vagrant.d
/Users/emvaldes/.vagrant.d
├── boxes
│   └── bento-VAGRANTSLASH-ubuntu-22.04
│       ├── 202212.11.0
│       │   └── virtualbox
│       │       ├── Vagrantfile
│       │       ├── box.ovf
│       │       ├── metadata.json
│       │       └── ubuntu-22.04-amd64-disk001.vmdk
│       └── metadata_url
├── data
│   ├── checkpoint_cache
│   ├── checkpoint_signature
│   ├── fp-leases
│   ├── lock.dotlock.lock
│   ├── lock.machine-action-6533b421ab71ab7fcdc9e16e11e04fba.lock
│   ├── machine-index
│   │   ├── index
│   │   └── index.lock
│   └── vbox_symlink_create_warning
├── gems
│   ├── 2.6.7
│   ├── 2.7.4
│   └── 2.7.6
├── insecure_private_key
├── rgloader
│   └── loader.rb
├── setup_version
├── sources
│   └── ubuntu-22.04
│       └── Vagrantfile
└── tmp

16 directories, 16 files
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ patch_vagrantfile
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local patch_vagrantfile=patch-vagrantfile
+ local remote_resource=platforms/vagrant/patch-vagrantfile
+ curl --silent --output /Users/emvaldes/.local/tmp/vagrant/patch-vagrantfile https://raw.githubusercontent.com/emvaldes/devops-systems/master/platforms/vagrant/patch-vagrantfile
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ patch /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04/Vagrantfile
patching file '/Users/emvaldes/.vagrant.d/sources/ubuntu-22.04/Vagrantfile'
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant validate
Vagrantfile validated successfully.
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ vagrant_deploy
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Importing base box 'bento/ubuntu-22.04'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'bento/ubuntu-22.04' version '202212.11.0' is up to date...
==> default: Setting the name of the VM: devops-console
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: The guest additions on this VM do not match the installed version of
    default: VirtualBox! In most cases this is fine, but in rare cases it can
    default: prevent things such as shared folders from working properly. If you see
    default: shared folder errors, please make sure the guest additions within the
    default: virtual machine match the version of VirtualBox you have installed on
    default: your host and reload your VM.
    default:
    default: Guest Additions Version: 6.1.40
    default: VirtualBox Version: 7.0
==> default: Setting hostname...
==> default: Mounting shared folders...
    default: /shared => /Users/emvaldes/.local/tmp/vagrant/shared
    default: /vagrant => /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ tree /Users/emvaldes/.vagrant.d/boxes/
/Users/emvaldes/.vagrant.d/boxes/
└── bento-VAGRANTSLASH-ubuntu-22.04
    ├── 202212.11.0
    │   └── virtualbox
    │       ├── Vagrantfile
    │       ├── box.ovf
    │       ├── box_update_check
    │       ├── metadata.json
    │       └── ubuntu-22.04-amd64-disk001.vmdk
    └── metadata_url

4 directories, 6 files
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ vagrant_config
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ vagrant status
Current machine states:

default                   running (virtualbox)

The VM is running. To stop this VM, you can run `vagrant halt` to
shut it down forcefully, or you can run `vagrant suspend` to simply
suspend the virtual machine. In either case, to restart it again,
simply run `vagrant up`.
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh-config
Host default
  HostName 127.0.0.1
  User vagrant
  Port 2222
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentityFile /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04/.vagrant/machines/default/virtualbox/private_key
  IdentitiesOnly yes
  LogLevel FATAL

+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ vagrant_access
+ local machine_configs=.vagrant/machines/default/virtualbox
+ cat /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04/.vagrant/machines/default/virtualbox/private_key
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAwM83aeNL1TqiiK6NRdQZDLmprGA1CkJkGkyaODkcQ9vql7jt
Ln1x58JcecGFgALWXfHabcGhdJwzE9H27NBfvD+9H94tfXezXZj8Ke1O4oaXiUBr
vrLxdpdQB9MGqjG8YZ4JF1bCcDTx5mb4kTN8xeS9ya5dUCb5LtL7/MIVmKvNHaXT
w30K7HAza3uFtsaCx+6R1eGyHRrwL36q3IKKe4FrofwdBxoifBs+Wv/FP6gDiqbV
hJTJqdEeUqQ+/y19soTaAitrBC8Xjm50ZzT8HfSF13KrBio4/TDHlQ1AvTCle4Oh
TVoC4B5V/UsffPEFhkoBoZnbzrIhOeqz130shQIDAQABAoIBAQCQLCJmdkTlG6Qf
ik4u8csNXeNG9uWSV1Sc6bzD38iH4XDIpMoN4lWDFC2sCY32y6hZtRg8y/YbyRTU
dEMsjx+XFx4nLy5azF/91ABypXVAI546TkaC4TF3GOwJ/bzVFL2lTNPFdOWNm7lq
LIMfqB1bqJBVt6Ek5w+a+L7eII6fikLLPdwXGBasx1+e9WsJR2L/dGCeLAap6APG
l/Z/4Iw9Dk3OPtVAAcRQGFZ8Q4xGvccbceCWoQP6F6Cyq90+nw6gzakYGs+mKFm2
R+JAXTvizYYjx55bDbfj0QsiM17Et9M8AXcFmLEG0QM1ThEmtsZyBgiwuImHOu9K
6uTyGq6dAoGBAOvbju3LKnYP4uLXHNcnwtwdr3r/sD2eVDLZsceME3qqyL1/SVpR
0C1/1z7h4uBX73/ExWwlmCHnB2kGL/ZpYbJFQCBSXxfUlYyDNaVpG4OrY4AkQugZ
R/bsodVQPcaM0p7vF1a7iJekqcSZ1NauRgkGc8Q+tgxNG2NeZ8pc1aFbAoGBANFG
hBUfJrzvaQWX2UsbRnl1LfWgCHap3Cd87dxvYVvWHsHOXAD1KYELru89Nv1/f1Au
FTZR5H3JLHUu95/sBBIuSsp3oBxUTvt3Hp+RdaVaOy1if6Pm5um0MaboHoFnGyS9
GJ/O/07eZUROsK499Em96SA6ObTwOX8aVBclnu+fAoGBAI3qvKPk3ZXQlUq8+QOV
TzC3RAGUnG1XOX6ncsuJQ6dJ4CP11SNdmw/lnpSdwrAO+XM96TTboiC0LMdLC80P
N9PWy3EnX0Sti5bS1JLFHeMqW2KdbwzNOXoghHggIiu4THuJjdeIW/YzBFvh3CmZ
D1ca5MmumkfolZRDF9yx43GFAoGAKUdugDgPzQ6wOYE1REJSCV0avqtdYAKrQUK8
LFHv80xt7q6EqU+yaxjh3aDGewQuGaOtXXSTzFflJAwqnenQ98EX0Y39D/l1Rta9
PJ5VhVMh/xbBtJO0En8PmCuK8N1klj+SXttWsrjdYrbe1M+1ouIJ3Oh/P3hu7upD
kflCu2MCgYAPQaCeK7BtrFZ70mEjk7/6KeSFjDNX42PigjPUfBhGa8+TGKESv5UQ
k3IEKk5yMLrrq71R/qyA+p43074AQYIaQzzTZEKut8dHFhoy+3apNgNccABo+2wk
3plFojXg9CX9lO+o20q+SebbYXoBJOnfbeJbgLIZelg19i4dQAcvwA==
-----END RSA PRIVATE KEY-----
+ vagrant ssh -c 'fold -b -w 70 /home/vagrant/.ssh/authorized_keys'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDAzzdp40vVOqKIro1F1BkMuamsYDUKQm
QaTJo4ORxD2+qXuO0ufXHnwlx5wYWAAtZd8dptwaF0nDMT0fbs0F+8P70f3i19d7NdmPwp
7U7ihpeJQGu+svF2l1AH0waqMbxhngkXVsJwNPHmZviRM3zF5L3Jrl1QJvku0vv8whWYq8
0dpdPDfQrscDNre4W2xoLH7pHV4bIdGvAvfqrcgop7gWuh/B0HGiJ8Gz5a/8U/qAOKptWE
lMmp0R5SpD7/LX2yhNoCK2sELxeObnRnNPwd9IXXcqsGKjj9MMeVDUC9MKV7g6FNWgLgHl
X9Sx988QWGSgGhmdvOsiE56rPXfSyF vagrant
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ service_account
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local script_name=service-account.shell
+ local remote_resource=platforms/vagrant/service-account.shell
+ curl --silent https://raw.githubusercontent.com/emvaldes/devops-systems/master/platforms/vagrant/service-account.shell
+ vagrant ssh -c 'bash -'

* Creating Service Account ...

Adding user `devops' ...
Adding new group `devops' (1001) ...
Adding new user `devops' (1001) with group `devops' ...
Creating home directory `/home/devops' ...
Copying files from `/etc/skel' ...

'/home/vagrant/.ssh' -> '/home/devops/.ssh'
'/home/vagrant/.ssh/authorized_keys' -> '/home/devops/.ssh/authorized_keys'

changed ownership of '/home/devops/.ssh/authorized_keys' from vagrant:vagrant to devops:devops
changed ownership of '/home/devops/.ssh' from vagrant:vagrant to devops:devops

* Completed Service Account!

+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ sudoers_privileges
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local script_name=sudoers-privileges.shell
+ local remote_resource=ubuntu/modules/sudoers-privileges.shell
+ curl --silent --output /Users/emvaldes/.local/tmp/vagrant/sudoers-privileges.shell https://raw.githubusercontent.com/emvaldes/devops-systems/master/ubuntu/modules/sudoers-privileges.shell
+ vagrant ssh -c 'bash -'
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ transfer_credentials
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ fold -b -w 70 /Users/emvaldes/.ssh/public/devnetops.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4
PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV
22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV
+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UX
X23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7U
so8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ cp -v /Users/emvaldes/.ssh/devnetops.pub /Users/emvaldes/.local/tmp/vagrant/shared/
/Users/emvaldes/.ssh/devnetops.pub -> /Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh -c 'cat /shared/devnetops.pub | sudo tee /home/devops/.ssh/authorized_keys'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UXX23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7Uso8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh -c 'sudo cat /home/devops/.ssh/authorized_keys | fold -b -w 70'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4
PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV
22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV
+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UX
X23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7U
so8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ rm -v /Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
/Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ sudoers_autologin
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local script_name=sudoers-autologin.shell
+ local remote_resource=ubuntu/modules/sudoers-autologin.shell
+ curl --silent --output /Users/emvaldes/.local/tmp/vagrant/sudoers-autologin.shell https://raw.githubusercontent.com/emvaldes/devops-systems/master/ubuntu/modules/sudoers-autologin.shell
+ vagrant ssh -c 'bash -'
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ service_access
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ cat /Users/emvaldes/.ssh/public/devnetops.pub
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UXX23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7Uso8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ cp -v /Users/emvaldes/.ssh/devnetops.pub /Users/emvaldes/.local/tmp/vagrant/shared/
/Users/emvaldes/.ssh/devnetops.pub -> /Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh -c 'cat /shared/devnetops.pub | sudo tee /home/devops/.ssh/authorized_keys'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UXX23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7Uso8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh -c 'sudo cat /home/devops/.ssh/authorized_keys | fold -b -w 70'
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCZD+9Rw8BheeVfhvujvDdsSnbgn1PBL4
PQObRKq0IpEW59JXxAt2XG4WlbMnAkCU9MifE5Kl0MCVmKUEwmTY1un87Q+Wt1lC/thaVV
22ABKbicO5TxYr0MRBiMO0fWN2KSjuxP1mIphzG7lNu45HNFkUShCbmo9QsO6JX0JlSOLV
+4CYbW7Znae8pE6duC+P9jFIMsQzUf/hectSX1V5xiozDb/wrjxhSeT5UqF3VwbT7WH4UX
X23MiAlL59F6sS4Xgs9j2Cc7DUY74pA5M3bChzJ7+bP8oTWvuvre6Qj8SXfo3QNvwbth7U
so8rtsXLEeOC2bGTMNoPokKfOW/Gvd devnetops
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ rm -v /Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
/Users/emvaldes/.local/tmp/vagrant/shared/devnetops.pub
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ config_section
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local 'private_sshkey=~/.ssh/private/devnetops'
+ local 'section_header=/Host vagrant--ubuntu-22.04'
+ sed -i '' '/Host vagrant--ubuntu-22.04/,/LogLevel FATAL/d' /Users/emvaldes/.ssh/config
+ sed -i '' '/^$/N;/^\n$/D' /Users/emvaldes/.ssh/config
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ vagrant ssh-config
+ sed -e 's|Host default|Host vagrant--ubuntu-22.04|g' -e 's|\(User \)\(.*\)|\1devops|g' -e 's|\( IdentityFile \)\(.*\)|\1~/.ssh/private/devnetops|g'
+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ egrep -A12 '^Host vagrant--ubuntu-22.04' /Users/emvaldes/.ssh/config
Host vagrant--ubuntu-22.04
  HostName 127.0.0.1
  User devops
  Port 2222
  UserKnownHostsFile /dev/null
  StrictHostKeyChecking no
  PasswordAuthentication no
  IdentityFile ~/.ssh/private/devnetops
  IdentitiesOnly yes
  LogLevel FATAL

+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ preinst_package
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local script_name=ubuntu-preinstall.shell
+ local remote_resource=ubuntu/modules/ubuntu-preinstall.shell
+ curl --silent https://raw.githubusercontent.com/emvaldes/devops-systems/master/ubuntu/modules/ubuntu-preinstall.shell
+ vagrant ssh -c 'bash -'

* Starting Pre-Install ...


WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
git is already the newest version (1:2.34.1-1ubuntu1.5).
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  libjq1 libonig5
The following NEW packages will be installed:
  jq libjq1 libonig5
0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.
Need to get 357 kB of archives.
After this operation, 1,087 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu jammy/main amd64 libonig5 amd64 6.9.7.1-2build1 [172 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu jammy/main amd64 libjq1 amd64 1.6-2.1ubuntu3 [133 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu jammy/main amd64 jq amd64 1.6-2.1ubuntu3 [52.5 kB]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin:
Fetched 357 kB in 2s (183 kB/s)
Selecting previously unselected package libonig5:amd64.
(Reading database ... 44068 files and directories currently installed.)
Preparing to unpack .../libonig5_6.9.7.1-2build1_amd64.deb ...
Unpacking libonig5:amd64 (6.9.7.1-2build1) ...
Selecting previously unselected package libjq1:amd64.
Preparing to unpack .../libjq1_1.6-2.1ubuntu3_amd64.deb ...
Unpacking libjq1:amd64 (1.6-2.1ubuntu3) ...
Selecting previously unselected package jq.
Preparing to unpack .../jq_1.6-2.1ubuntu3_amd64.deb ...
Unpacking jq (1.6-2.1ubuntu3) ...
Setting up libonig5:amd64 (6.9.7.1-2build1) ...
Setting up libjq1:amd64 (1.6-2.1ubuntu3) ...
Setting up jq (1.6-2.1ubuntu3) ...
Processing triggers for man-db (2.10.2-1) ...
Processing triggers for libc-bin (2.35-0ubuntu3.1) ...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following NEW packages will be installed:
  python-is-python3
0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
Need to get 2,788 B of archives.
After this operation, 13.3 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu jammy/main amd64 python-is-python3 all 3.9.2-2 [2,788 B]
debconf: unable to initialize frontend: Dialog
debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin:
Fetched 2,788 B in 0s (11.1 kB/s)
Selecting previously unselected package python-is-python3.
(Reading database ... 44085 files and directories currently installed.)
Preparing to unpack .../python-is-python3_3.9.2-2_all.deb ...
Unpacking python-is-python3 (3.9.2-2) ...
Setting up python-is-python3 (3.9.2-2) ...
Processing triggers for man-db (2.10.2-1) ...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.

* Completed Pre-Install!

+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ postinst_package
+ cd /Users/emvaldes/.vagrant.d/sources/ubuntu-22.04
+ local script_name=ubuntu-postinstall.shell
+ local remote_resource=ubuntu/modules/ubuntu-postinstall.shell
+ curl --silent https://raw.githubusercontent.com/emvaldes/devops-systems/master/ubuntu/modules/ubuntu-postinstall.shell
+ vagrant ssh -c 'bash -'

* Starting Framework Deployment ...

Cloning into '/tmp/devops-systems'...

* Completed Framework Deployment!

+ check_status 0
+ status=0
+ [[ 0 -ne 0 ]]
+ return 0
+ return 0
+ return 0
